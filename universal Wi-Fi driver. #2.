// Pseudocode for a universal Wi-Fi dongle driver

// Abstract hardware interface
struct wifi_device {
    void *hardware_handle;
    int (*initialize)(struct wifi_device *);
    int (*send)(struct wifi_device *, void *data, size_t len);
    int (*receive)(struct wifi_device *, void *buffer, size_t len);
    void (*shutdown)(struct wifi_device *);
};

#ifdef _WIN32
// Windows-specific implementation
#include <windows.h>
int windows_initialize(struct wifi_device *dev) { /* ... */ }
int windows_send(struct wifi_device *dev, void *data, size_t len) { /* ... */ }
int windows_receive(struct wifi_device *dev, void *buffer, size_t len) { /* ... */ }
void windows_shutdown(struct wifi_device *dev) { /* ... */ }
#endif

#ifdef __APPLE__
// macOS-specific implementation
#include <IOKit/...>
int mac_initialize(struct wifi_device *dev) { /* ... */ }
int mac_send(struct wifi_device *dev, void *data, size_t len) { /* ... */ }
int mac_receive(struct wifi_device *dev, void *buffer, size_t len) { /* ... */ }
void mac_shutdown(struct wifi_device *dev) { /* ... */ }
#endif

#ifdef __linux__
// Linux-specific implementation
#include <linux/kernel.h>
#include <libusb.h>
int linux_initialize(struct wifi_device *dev) { /* ... */ }
int linux_send(struct wifi_device *dev, void *data, size_t len) { /* ... */ }
int linux_receive(struct wifi_device *dev, void *buffer, size_t len) { /* ... */ }
void linux_shutdown(struct wifi_device *dev) { /* ... */ }
#endif

// Factory function to create device
struct wifi_device *create_wifi_device() {
    struct wifi_device *dev = malloc(sizeof(struct wifi_device));
#ifdef _WIN32
    dev->initialize = windows_initialize;
    dev->send = windows_send;
    dev->receive = windows_receive;
    dev->shutdown = windows_shutdown;
#endif
#ifdef __APPLE__
    dev->initialize = mac_initialize;
    dev->send = mac_send;
    dev->receive = mac_receive;
    dev->shutdown = mac_shutdown;
#endif
#ifdef __linux__
    dev->initialize = linux_initialize;
    dev->send = linux_send;
    dev->receive = linux_receive;
    dev->shutdown = linux_shutdown;
#endif
    return dev;
}

// Usage
struct wifi_device *device = create_wifi_device();
device->initialize(device);
// ... use device
device->shutdown(device);